{"ast":null,"code":"import _classCallCheck from \"/Users/teodordanielsen/pureokrs/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/teodordanielsen/pureokrs/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { EventEmitter } from '@angular/core';\nimport { faPlusCircle, faPen, faTrashAlt, faUserNinja, faBatteryEmpty, faAdjust, faCheckCircle, faChevronUp, faChevronDown, faEllipsisH } from '@fortawesome/free-solid-svg-icons';\nimport { OkrService } from '../../okr.service';\nimport { AuthenticationService } from '../../authentication.service';\nimport { UserService } from '../../user.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../okr.service\";\nimport * as i2 from \"../../authentication.service\";\nimport * as i3 from \"../../user.service\";\nimport * as i4 from \"node_modules/@fortawesome/angular-fontawesome\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../progress-badge/progress-badge.component\";\n\nfunction OkrNodeComponent_span_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 15);\n    i0.ɵɵelement(1, \"fa-icon\", 3);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r0.faUserNinja);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.owner.name, \" \");\n  }\n}\n\nfunction OkrNodeComponent_ul_21_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"app-progress-badge\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var kr_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", kr_r6 == null ? null : kr_r6.keyResult, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"progress\", kr_r6.progress);\n  }\n}\n\nfunction OkrNodeComponent_ul_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 16);\n    i0.ɵɵtemplate(1, OkrNodeComponent_ul_21_li_1_Template, 3, 2, \"li\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.okrHierarchyNode.data.okr.keyResults);\n  }\n}\n\nfunction OkrNodeComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵlistener(\"click\", function OkrNodeComponent_div_22_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      var ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.showChildren();\n    });\n    i0.ɵɵelement(1, \"fa-icon\", 3);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r2.faChevronDown);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.okrHierarchyNode.children.length, \" \");\n  }\n}\n\nfunction OkrNodeComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵlistener(\"click\", function OkrNodeComponent_div_23_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      var ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.hideChildren();\n    });\n    i0.ɵɵelement(1, \"fa-icon\", 3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r3.faChevronUp);\n  }\n}\n\nfunction OkrNodeComponent_div_24_app_okr_node_1_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-okr-node\", 23);\n    i0.ɵɵlistener(\"deletedNode\", function OkrNodeComponent_div_24_app_okr_node_1_Template_app_okr_node_deletedNode_0_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      var ctx_r13 = i0.ɵɵnextContext(2);\n      return ctx_r13.hideDeletedNode($event);\n    })(\"okrNodeToEdit\", function OkrNodeComponent_div_24_app_okr_node_1_Template_app_okr_node_okrNodeToEdit_0_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      var ctx_r15 = i0.ɵɵnextContext(2);\n      return ctx_r15.editOkrNode($event);\n    })(\"parentId\", function OkrNodeComponent_div_24_app_okr_node_1_Template_app_okr_node_parentId_0_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      var ctx_r16 = i0.ɵɵnextContext(2);\n      return ctx_r16.addChild($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var child_r12 = ctx.$implicit;\n    i0.ɵɵproperty(\"okrHierarchyNode\", child_r12);\n  }\n}\n\nfunction OkrNodeComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtemplate(1, OkrNodeComponent_div_24_app_okr_node_1_Template, 1, 1, \"app-okr-node\", 22);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.okrHierarchyNode.children);\n  }\n}\n\nexport var OkrNodeComponent = /*#__PURE__*/(function () {\n  var OkrNodeComponent = /*#__PURE__*/function () {\n    function OkrNodeComponent(okrService, auth, userService) {\n      _classCallCheck(this, OkrNodeComponent);\n\n      this.okrService = okrService;\n      this.auth = auth;\n      this.userService = userService;\n      this.faPlusCircle = faPlusCircle;\n      this.faPen = faPen;\n      this.faTrashAlt = faTrashAlt;\n      this.faUserNinja = faUserNinja;\n      this.faBatteryEmpty = faBatteryEmpty;\n      this.faAdjust = faAdjust;\n      this.faCheckCircle = faCheckCircle;\n      this.faChevronUp = faChevronUp;\n      this.faChevronDown = faChevronDown;\n      this.faEllipsisH = faEllipsisH;\n      this.deletedNode = new EventEmitter();\n      this.parentId = new EventEmitter();\n      this.okrNodeToEdit = new EventEmitter();\n    }\n\n    _createClass(OkrNodeComponent, [{\n      key: \"ngOnChanges\",\n      value: function ngOnChanges() {\n        this.getOwner();\n        this.getAverageProgress();\n      }\n    }, {\n      key: \"addChild\",\n      value: function addChild(parentId) {\n        this.parentId.emit(parentId);\n      }\n    }, {\n      key: \"editOkrNode\",\n      value: function editOkrNode(okrNode) {\n        this.okrNodeToEdit.emit(okrNode);\n      }\n    }, {\n      key: \"showChildren\",\n      value: function showChildren() {\n        this.okrHierarchyNode.data.isChildrenVisible = true;\n      }\n    }, {\n      key: \"hideChildren\",\n      value: function hideChildren() {\n        this.okrHierarchyNode.data.isChildrenVisible = false;\n      }\n    }, {\n      key: \"getAverageProgress\",\n      value: function getAverageProgress() {\n        var sum = 0;\n        var count = 0;\n        this.okrHierarchyNode.data.okr.keyResults.forEach(function (kr) {\n          if (kr.progress) {\n            sum += kr.progress;\n          }\n\n          count += 1;\n        });\n        this.averageProgress = Math.round(sum / count);\n      }\n    }, {\n      key: \"getOwner\",\n      value: function getOwner() {\n        var _this = this;\n\n        if (this.okrHierarchyNode.data.okr.userId) {\n          this.userService.getUser(this.okrHierarchyNode.data.okr.userId).subscribe(function (owner) {\n            _this.owner = owner;\n          });\n        }\n      }\n    }, {\n      key: \"deleteOKR\",\n      value: function deleteOKR() {\n        var _this2 = this;\n\n        this.okrService.deleteOkr(this.okrHierarchyNode.data.okr).subscribe(function () {\n          return _this2.hideDeletedNode(_this2.okrHierarchyNode);\n        });\n      }\n    }, {\n      key: \"hideDeletedNode\",\n      value: function hideDeletedNode(okrHierarchyNode) {\n        this.deletedNode.emit(okrHierarchyNode);\n      }\n    }]);\n\n    return OkrNodeComponent;\n  }();\n\n  OkrNodeComponent.ɵfac = function OkrNodeComponent_Factory(t) {\n    return new (t || OkrNodeComponent)(i0.ɵɵdirectiveInject(i1.OkrService), i0.ɵɵdirectiveInject(i2.AuthenticationService), i0.ɵɵdirectiveInject(i3.UserService));\n  };\n\n  OkrNodeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OkrNodeComponent,\n    selectors: [[\"app-okr-node\"]],\n    inputs: {\n      okrHierarchyNode: \"okrHierarchyNode\"\n    },\n    outputs: {\n      deletedNode: \"deletedNode\",\n      parentId: \"parentId\",\n      okrNodeToEdit: \"okrNodeToEdit\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 25,\n    vars: 11,\n    consts: [[1, \"okr\", \"card\", \"rounded\", \"border-0\", \"p-2\", \"my-1\"], [1, \"dropdown\"], [\"id\", \"dropdownMenuButton\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"btn\", \"btn-sm\", \"p-0\", \"m-0\"], [3, \"icon\"], [\"aria-labelledby\", \"dropdownMenuButton\", 1, \"dropdown-menu\"], [\"data-toggle\", \"modal\", \"data-target\", \"#newOkrModal\", 1, \"dropdown-item\", 3, \"click\"], [\"data-toggle\", \"modal\", \"data-target\", \"#editOkrModal\", 1, \"dropdown-item\", 3, \"click\"], [1, \"dropdown-item\", 3, \"click\"], [\"class\", \"text-muted small m-1\", 4, \"ngIf\"], [1, \"float-right\", \"mr-2\", 3, \"progress\"], [1, \"font-weight-bold\", \"mt-2\", \"mb-1\"], [1, \"card-body\", \"py-0\", \"pr-0\", \"m-0\"], [\"class\", \"list-group\", 4, \"ngIf\"], [\"class\", \"btn btn-link btn-sm p-0 m-0\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"ml-4 mt-1\", 4, \"ngIf\"], [1, \"text-muted\", \"small\", \"m-1\"], [1, \"list-group\"], [\"class\", \"list-group-item small bg-light border border-info rounded-0 border-right-0 border-top-0 border-bottom-0 pt-1 pb-0 my-1 mr-2\", 4, \"ngFor\", \"ngForOf\"], [1, \"list-group-item\", \"small\", \"bg-light\", \"border\", \"border-info\", \"rounded-0\", \"border-right-0\", \"border-top-0\", \"border-bottom-0\", \"pt-1\", \"pb-0\", \"my-1\", \"mr-2\"], [1, \"float-right\", 3, \"progress\"], [1, \"btn\", \"btn-link\", \"btn-sm\", \"p-0\", \"m-0\", 3, \"click\"], [1, \"ml-4\", \"mt-1\"], [3, \"okrHierarchyNode\", \"deletedNode\", \"okrNodeToEdit\", \"parentId\", 4, \"ngFor\", \"ngForOf\"], [3, \"okrHierarchyNode\", \"deletedNode\", \"okrNodeToEdit\", \"parentId\"]],\n    template: function OkrNodeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"span\", 1);\n        i0.ɵɵelementStart(2, \"a\", 2);\n        i0.ɵɵelement(3, \"fa-icon\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"a\", 5);\n        i0.ɵɵlistener(\"click\", function OkrNodeComponent_Template_a_click_5_listener() {\n          return ctx.addChild(ctx.okrHierarchyNode.data.okr._id);\n        });\n        i0.ɵɵelement(6, \"fa-icon\", 3);\n        i0.ɵɵtext(7, \" Add child OKR \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"a\", 6);\n        i0.ɵɵlistener(\"click\", function OkrNodeComponent_Template_a_click_8_listener() {\n          return ctx.editOkrNode(ctx.okrHierarchyNode);\n        });\n        i0.ɵɵelement(9, \"fa-icon\", 3);\n        i0.ɵɵtext(10, \" Edit \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"a\", 7);\n        i0.ɵɵlistener(\"click\", function OkrNodeComponent_Template_a_click_11_listener() {\n          return ctx.deleteOKR();\n        });\n        i0.ɵɵelement(12, \"fa-icon\", 3);\n        i0.ɵɵtext(13, \" Delete \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"span\");\n        i0.ɵɵtemplate(15, OkrNodeComponent_span_15_Template, 3, 2, \"span\", 8);\n        i0.ɵɵelement(16, \"app-progress-badge\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"p\", 10);\n        i0.ɵɵelementStart(18, \"span\");\n        i0.ɵɵtext(19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 11);\n        i0.ɵɵtemplate(21, OkrNodeComponent_ul_21_Template, 2, 1, \"ul\", 12);\n        i0.ɵɵtemplate(22, OkrNodeComponent_div_22_Template, 3, 2, \"div\", 13);\n        i0.ɵɵtemplate(23, OkrNodeComponent_div_23_Template, 2, 1, \"div\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(24, OkrNodeComponent_div_24_Template, 2, 1, \"div\", 14);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"icon\", ctx.faEllipsisH);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"icon\", ctx.faPlusCircle);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"icon\", ctx.faPen);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"icon\", ctx.faTrashAlt);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.owner);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"progress\", ctx.averageProgress);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.okrHierarchyNode.data.okr.objective);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.okrHierarchyNode.data.okr.keyResults);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.okrHierarchyNode.data.isChildrenVisible && (ctx.okrHierarchyNode.children == null ? null : ctx.okrHierarchyNode.children.length) > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.okrHierarchyNode.data.isChildrenVisible && (ctx.okrHierarchyNode.children == null ? null : ctx.okrHierarchyNode.children.length) > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.okrHierarchyNode.data.isChildrenVisible);\n      }\n    },\n    directives: [i4.FaIconComponent, i5.NgIf, i6.ProgressBadgeComponent, i5.NgForOf, OkrNodeComponent],\n    styles: [\".okr[_ngcontent-%COMP%]{width:500px;max-width:500px}.dropdown-item[_ngcontent-%COMP%]:hover{cursor:pointer}@media only screen and (max-width: 768px){[class*=okr][_ngcontent-%COMP%]{width:100%;max-width:100%}}\"]\n  });\n  return OkrNodeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}
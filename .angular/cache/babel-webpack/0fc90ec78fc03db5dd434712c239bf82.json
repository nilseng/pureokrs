{"ast":null,"code":"import _slicedToArray from \"/Users/teodordanielsen/pureokrs/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/Users/teodordanielsen/pureokrs/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/teodordanielsen/pureokrs/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { ElementRef } from '@angular/core';\nimport { OkrService } from '../okr.service';\nimport { AuthenticationService } from '../authentication.service';\nimport { combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../okr.service\";\nimport * as i2 from \"../authentication.service\";\nvar _c0 = [\"svg\"];\nvar _c1 = [\"container\"];\nvar _c2 = [\"modal\"];\n\nfunction OkrTreeComponent_h5_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h5\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var user_r3 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", user_r3.company, \"'s objectives and key results.\\n\");\n  }\n}\n\nfunction OkrTreeComponent_div_2_app_edit_okr_2_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-edit-okr\", 11);\n    i0.ɵɵlistener(\"savedOkr\", function OkrTreeComponent_div_2_app_edit_okr_2_Template_app_edit_okr_savedOkr_0_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      var ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.savedOkr($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"okrHierarchyNode\", ctx_r5.okrNodeToEdit);\n  }\n}\n\nfunction OkrTreeComponent_div_2__svg_g_8__svg_g_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelement(0, \"g\", 13);\n  }\n\n  if (rf & 2) {\n    var edge_r12 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"edge\", edge_r12);\n  }\n}\n\nfunction OkrTreeComponent_div_2__svg_g_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"g\");\n    i0.ɵɵtemplate(1, OkrTreeComponent_div_2__svg_g_8__svg_g_1_Template, 1, 1, \"g\", 12);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var edge_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", edge_r12.source.depth);\n  }\n}\n\nfunction OkrTreeComponent_div_2__svg_g_9__svg_g_1_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"g\", 15);\n    i0.ɵɵlistener(\"nodeShow\", function OkrTreeComponent_div_2__svg_g_9__svg_g_1_Template__svg_g_nodeShow_0_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      var ctx_r17 = i0.ɵɵnextContext(3);\n      return ctx_r17.pushChildren($event);\n    })(\"nodeHide\", function OkrTreeComponent_div_2__svg_g_9__svg_g_1_Template__svg_g_nodeHide_0_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      var ctx_r19 = i0.ɵɵnextContext(3);\n      return ctx_r19.hideChildren($event);\n    })(\"okrNodeToEdit\", function OkrTreeComponent_div_2__svg_g_9__svg_g_1_Template__svg_g_okrNodeToEdit_0_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      var ctx_r20 = i0.ɵɵnextContext(3);\n      return ctx_r20.editOkrNode($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var node_r15 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"okrTreeNode\", node_r15);\n  }\n}\n\nfunction OkrTreeComponent_div_2__svg_g_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"g\");\n    i0.ɵɵtemplate(1, OkrTreeComponent_div_2__svg_g_9__svg_g_1_Template, 1, 1, \"g\", 14);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var node_r15 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", node_r15.depth);\n  }\n}\n\nfunction OkrTreeComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r23 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelementStart(1, \"app-new-okr\", 3);\n    i0.ɵɵlistener(\"savedOkr\", function OkrTreeComponent_div_2_Template_app_new_okr_savedOkr_1_listener($event) {\n      i0.ɵɵrestoreView(_r23);\n      var ctx_r22 = i0.ɵɵnextContext();\n      return ctx_r22.savedOkr($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(2, OkrTreeComponent_div_2_app_edit_okr_2_Template, 1, 1, \"app-edit-okr\", 4);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(3, \"svg\", 5, 6);\n    i0.ɵɵelement(5, \"rect\", 7);\n    i0.ɵɵelementStart(6, \"g\", 8, 9);\n    i0.ɵɵtemplate(8, OkrTreeComponent_div_2__svg_g_8_Template, 2, 1, \"g\", 10);\n    i0.ɵɵtemplate(9, OkrTreeComponent_div_2__svg_g_9_Template, 2, 1, \"g\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var vm_r4 = ctx.ngIf;\n\n    var _r6 = i0.ɵɵreference(4);\n\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.okrNodeToEdit);\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"height\", vm_r4.config.height)(\"width\", vm_r4.config.width);\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"height\", vm_r4.config.height)(\"width\", vm_r4.config.width);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"zoomableOf\", _r6);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", vm_r4.tree == null ? null : vm_r4.tree.links());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", vm_r4.tree == null ? null : vm_r4.tree.descendants());\n  }\n}\n\nfunction OkrTreeComponent_div_4_app_loading_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-loading\");\n  }\n}\n\nfunction OkrTreeComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, OkrTreeComponent_div_4_app_loading_1_Template, 1, 0, \"app-loading\", 0);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var isLoading_r24 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", isLoading_r24);\n  }\n}\n\nexport var OkrTreeComponent = /*#__PURE__*/(function () {\n  var OkrTreeComponent = /*#__PURE__*/function () {\n    function OkrTreeComponent(okrService, authService) {\n      _classCallCheck(this, OkrTreeComponent);\n\n      this.okrService = okrService;\n      this.authService = authService;\n      this.tree$ = this.okrService.okrTreeWithActions$;\n      this.okrTreeIsLoading$ = this.okrService.okrTreeIsLoading$;\n      this.okrTreeConfig$ = this.okrService.treeConfig$;\n      this.vm$ = combineLatest([this.tree$, this.okrTreeConfig$]).pipe(map(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            tree = _ref2[0],\n            config = _ref2[1];\n\n        return {\n          tree: tree,\n          config: config\n        };\n      }));\n      this.user$ = this.authService.getUserDetails();\n    }\n\n    _createClass(OkrTreeComponent, [{\n      key: \"onOrientationChange\",\n      value: function onOrientationChange(event) {\n        this.getTreeConfig();\n      }\n    }, {\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        this.getTreeConfig();\n      }\n    }, {\n      key: \"getTreeConfig\",\n      value: function getTreeConfig() {\n        // Adjusting for padding in main element in case of wide screen, otherwise 100% width\n        var width = window.innerWidth > 768 ? window.innerWidth - 160 : window.innerWidth;\n        var treeConfig = {\n          width: width,\n          height: Math.max(window.innerHeight * 0.6, 500),\n          nodeWidth: 160,\n          nodeHeight: 70,\n          offsetX: width / 2 - 160 / 2,\n          offsetY: -70\n        };\n        this.okrService.treeConfigSubject.next(treeConfig);\n      }\n    }, {\n      key: \"savedOkr\",\n      value: function savedOkr(okrNode) {\n        this.okrService.okrSaved(okrNode);\n      }\n    }, {\n      key: \"editOkrNode\",\n      value: function editOkrNode(okrNode) {\n        this.okrNodeToEdit = okrNode;\n      }\n    }]);\n\n    return OkrTreeComponent;\n  }();\n\n  OkrTreeComponent.ɵfac = function OkrTreeComponent_Factory(t) {\n    return new (t || OkrTreeComponent)(i0.ɵɵdirectiveInject(i1.OkrService), i0.ɵɵdirectiveInject(i2.AuthenticationService));\n  };\n\n  OkrTreeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OkrTreeComponent,\n    selectors: [[\"app-okr-tree\"]],\n    viewQuery: function OkrTreeComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(_c1, 7);\n        i0.ɵɵviewQuery(_c2, 7);\n      }\n\n      if (rf & 2) {\n        var _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.svgEl = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.containerEl = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.modal = _t.first);\n      }\n    },\n    hostBindings: function OkrTreeComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"orientationchange\", function OkrTreeComponent_orientationchange_HostBindingHandler($event) {\n          return ctx.onOrientationChange($event);\n        }, false, i0.ɵɵresolveWindow);\n      }\n    },\n    decls: 6,\n    vars: 9,\n    consts: [[4, \"ngIf\"], [\"class\", \"mb-4\", 4, \"ngIf\"], [1, \"mb-4\"], [3, \"savedOkr\"], [3, \"okrHierarchyNode\", \"savedOkr\", 4, \"ngIf\"], [\"overflow\", \"hidden\", 2, \"margin\", \"auto\", \"display\", \"block\"], [\"svg\", \"\"], [\"rx\", \"2\", \"ry\", \"2\", \"fill\", \"white\"], [\"id\", \"container\", 3, \"zoomableOf\"], [\"container\", \"\"], [4, \"ngFor\", \"ngForOf\"], [3, \"okrHierarchyNode\", \"savedOkr\"], [3, \"edge\", 4, \"ngIf\"], [3, \"edge\"], [3, \"okrTreeNode\", \"nodeShow\", \"nodeHide\", \"okrNodeToEdit\", 4, \"ngIf\"], [3, \"okrTreeNode\", \"nodeShow\", \"nodeHide\", \"okrNodeToEdit\"]],\n    template: function OkrTreeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, OkrTreeComponent_h5_0_Template, 2, 1, \"h5\", 0);\n        i0.ɵɵpipe(1, \"async\");\n        i0.ɵɵtemplate(2, OkrTreeComponent_div_2_Template, 10, 8, \"div\", 1);\n        i0.ɵɵpipe(3, \"async\");\n        i0.ɵɵtemplate(4, OkrTreeComponent_div_4_Template, 2, 1, \"div\", 0);\n        i0.ɵɵpipe(5, \"async\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 3, ctx.user$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(3, 5, ctx.vm$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(5, 7, ctx.okrTreeIsLoading$));\n      }\n    },\n    styles: [\"\"]\n  });\n  return OkrTreeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}